:prog: The pass:[Developer's] Guide
=== Linux Makefile Example

In order to build _WSJT-X_ form source, install the following packages:

[source,shell]
----------
# DEBIAN, UBUNTU, MINT and FRIENDS
sudo apt-get install gcc g++ gfortran make libfftw3-dev \
libpulse-dev libhamlib-dev qtbase5-dev  pulseaudio subversion \
libgfortran3:i386 libc6-i386 libqt5multimedia5-plugins \
qtmultimedia5-dev
----------

Adjust the install method to your distribution package manager.

==== WSJT-X Dependencies
[horizontal]
+*gcc*+:: GNU C Compiler
+*g{plus}{plus}*+:: GNU C{plus}{plus} Compiler
+*gfortran*+:: GNU Fortran or F90
+*make*+:: GNU Make
+*libqt5multimedia5-plugins*+:: QT5 Media Plugins
+*libfftw3-dev*+:: Fast Fourier Transforms
+*libpulse-dev*+:: Headers and Files for Pulse AUdio
+*libhamlib-dev*+:: Headers and Files for Hamlib
+*qtbase5-dev*+:: QT5 Base Dev Files
+*qtmultimedia5-dev*+:: Qt5 Multimedia Dev Files
+*pulseaudio*+:: Pulse Audio Sound Driver
+*subversion*+:: Version Control Software
+*libgfortran.so.3*+:: Fortran Library
+*libc.so.6*+:: GCC C Library
+*libm.so.6*+:: GCC C Library
+*libgcc_s.so.1libm.so.6*+:: GCC C Library 
+*libquadmath.so.0*+:: Quad-Precision Math Library

==== Build Methods

IMPORTANT: You can perform the steps <<MANUAL,manually>> if desired. Using the
<<BUILDSH,script>> automates the steps.

* Open a terminal session, +*Ctrl{plus}Alt{plus}T*+
* Checkout the build script from SVN:

[[BUILDSH]]
[source,shell]
.SVN export wsjtx-build.sh
----------
# SVN CHECKOUT WSJTX-COMPILE.SH

svn export svn://svn.berlios.de/wsjt/branches/doc/dev-guide/source/wsjtx-compile.sh

----------

.Manual Entry
* For manual entry, start at +*BUILD_DIR=~/Projects/wsjtx-build*+ and
perform each step that does not start with start with "#" sign. Use +*Copy {amp}
Paste*+.

.Using the Script
* Using The Build <<BUILDSH,Script>>, Change Permission and Run

[source,bash]
----------
# CHANGE PERMISSION
chmod +x ./wsjtx-compile.sh

# RUN SCRIPT
./wsjtx-compile.sh
----------

[[MANUAL]]
[source,bash]
.wsjtx-compile.sh
----------
include::wsjtx-compile.sh[]
----------

==== Test KVASD

Before you launch _WSJT-X_, ensure _KVASD_ can run.

[source,bash]
.KVASD Tests
----------
# CHANGE DIRECTORY and RUN KVASD
cd wsjtx-$rev_num
./kvasd -v

# SUCESSFUL RETURN
KVASD version 1.11

# VIEW COPYRGHT
./kvasd

----------

==== Run WSJT-X

[source,bash]
----------
# When running from a terminal [ ./wsjtx ], the xterm remains open.
# This is good for testing and chasing errors. Run WSJT-X with:

./wsjtx

# You can also use a file manager. Browse to WSJT-X dir, and open
# as you would any other program. Using this method to launch, you
# should not see the terminal window.

----------

=== Windows CMake Example

[[EXAMPLE]]
For this example, the following setup was used:

[horizontal]
+*OS*+:: Windows Vista 64 bit
+*Install Path*+:: C:\
+*Paths Tested*+:: +++D:\  F:\  G:\tools+++ (all passed)
+*Final Path*+:: C:\wsjt-env
+*Setup Method*+:: wsjtx-build-setup.bat
+*Build Method*+:: wsjtx-build-cmake.bat

==== Language Used In This Section

[horizontal]
+*Windows CMD Terminal+*:: Standard Windows Command Terminal
+*WSJT Env Terminal*+:: Command Termal With Paths Specific to WSJT Needs
+*Setup Script*+:: Batch File Used to Setup WSJT Env
+*Build Script*+:: Batch File Used to Build WSJT-X
+*Tool Chain File*+:: CMake Configuration File Used by the Build Script

==== Environment Setup

The setup script provided will create the needed folder structure, download the
+*Build Script (wsjtx-build-cmake.bat)*+ and +*CMake Tool Chain_ file
(wsjtx-toolchain.cmake)*+. You can save this script anywhere you like. Following
this <<EXAMPLE,example>> will build the structure in <<TREE,Figure-2>>
when the +*Setup Script*+ has been saved to +*C:\*+ directory.

In the future, this setup script will be ammended 

IMPORTANT: With the exception of {svn}, The entire development environment is
contained within: +*C:\wsjt-env*+. Using the +*WSJT Env Terminal*+, previous
installations of +*QT*+ or +*CMake*+ should not be pose a problem to
either environment.

* Open a +*Windows CMD Terminal*+ and perform the following steps:

[[SETUP]]
[source,shell]
---------
# CHANGE DIRECTORY TO INSTALL LOCATION
c:

# SVN EXPORT
svn export svn://svn.berlios.de/wsjt/branches/doc/dev-guide/source/wsjtx-build-setup.bat

# RUN SETUP
c:\wsjtx-build-setup.bat

# SETUP SCRIPT SHOULD EXIT
---------

* If there were no errors, the tree should look like <<TREE,Figure-1>>
* To check the tree, browse to +*C:\wsjt-env*+, Double-Click or Right-Click
{amp} Open +*WSJT Env Terminal (wsjt-env.bat)*+
* In +*WSJT Env Terminal*+

[source,shell]
----------
# CHANGE DIRCTORY
c:
cd wsjt-env

# RUN TREE
tree
----------

[[TREE]]
.WSJT Env Directory Tree 
image::images/wsjt-env-tree.png[align="left"]

==== Download Development Packages

* Save the following packages to +*C:\wsjt-env\downloads*+
* The follow each section for specific on installation
* If Subversoin is already installed, and reachable from your PATH, you can
skip SlikSVN download and install

[horizontal]
+*Qt5 SDK*+:: {qt5_framework} - Qt 5.2.1 Windows-32, (MinGW 4.8, OpenGL)
+*CMake*+:: {cmake} - Win32 Installer
+*Hamlib*+:: {hamlib} - Hamlib 1.2.15.3.zip
+*FFTW3*+:: {fftw3} - 32-bit version: fftw-3.3.3-dll32.zip
+*SVN*+:: {svn} - SilkSVN 1.8.5.x 32-bit
+*MS Tools*+:: {mstools} - Microsoft Tool Kit

.QT5.2.1 Install
* Run the Installer
* Change Install Path to: +*C:\wsjt-env\Qt5*+
* Check: Associate common files types with Qt Creator
* Select Components: Use Default Selections
* License Agreement, read and select
* Start Menu: Use default selections, select next, then install
* Go grab a coffee, this takes about +*5*+ minutes to install
* At Finish, launch Qt Creator to verify it works, then exit

.CMake Install
* Run the Installer
* Agree to Terms
* Select: Do [red]*#not#* add to system PATH
* Change Install Path to: +*C:\wsjt-env\CMake*+

.Extract Hamlib
* Unzip hamlib-1.2.15.3.zip
* Copy the contents of +*hamlib-win32-1.2.15.3*+ into +*\hamlib*+. You should
end up with: +*c:\wsjt-env\hamlib\bin hamlib\bin hamlib\include ..*+

.Extract FFTW3
* [red]*#Caution#*: FFTW3 does *not* have a top level folder
* Copy +*fftw-3.3.3-dll32.zip  =>  C:\wsjt-env\fftw3f*+
* Extract in +*C:\wsjt-env\fftw3f*+ into +*c:\wsjt-env\fftw3f\*+
* Delete +*fftw-3.3.3-dll32.zip*+

.SilkSVN Install
* Run the Installer
* Agree to Terms
* Change Install Path to: +*C:\wsjt-env\SlikSvn*+
* Select Typical, then Install
* Note: All the SVN installers I tested, added itself to the users
%PATH%, without an option to selct Yes or No.

[[MSTOOLS,MS Tools]]
.MS Tools - Win-XP
* Windows Vista and beyond should not need this 
* In a +*Windows CMD Terminal*+: +*c:\robocopy /?*+
* If not installed, {mstools}
* Run the installer 

==== Building WSJT-X with CMake
 
* After installing the development packages, browse to +*C:\wsjt-env*+
* Double-Click or Right-Click {amp} Open +*WSJT Env Terminal (wsjt-env.bat)+.
* If all packages are reachable, +*WSJT Env Terminal*+ should list the required
_WSJT-X_ build packages and their respective versions, see <<TOOLS,Figure-2>>.
 
[[TOOLS]]
.WSJT-X Build Tools 
image::images/wsjt-env.png[align="left"]

* If dependencies are missing, or the script cannot find a path, it should
display a warning, list which package is missing, then exit.

==== Test Run
* Browse to +*C:\wsjt-env*+, Double-Click or Right-Click {amp} Open 
+*WSJT Env Terminal (wsjt-env.bat)*+.
* In the terminal, type:

.Build Release version
[source,shell]
---------
wsjtx-build-cmake.bat -r
---------
* _WSJT-X_ Release Binary Location: +*C:\wsjt-env\wsjtx-install\Release\bin*+
* Note the [green]*#Release#\bin* directory

.Build Debug version
[source,shell]
---------
wsjtx-build-cmake.bat -d
---------

* _WSJT-X_ Debug Binary Location: +*C:\wsjt-env\wsjtx-install\Debug\bin*+
* Note the [green]*#Debug#\bin* directory
