:page: The WSJT Developers Guide

[[BASE_ENV]]
Before you can start developing _WSJT_ applications, you must first 
set up your environment. _{page}_ will use the respective *SDK*
on Windows and _/home/$USER/jtsdk_ plus build scripts on Linux.

.The Containment Area Provides:
* A fixed structure to work from
* Provides system independent build tools
* Produce repeatable results
* Create an experimental area to test builds
* Allows full testing without system installation
* Provide build methods for non-developer testing

.Windows Environment
The *SDK* provides the containment, plus it includes required tools to
build a particular application and in some cased, several sub-elements
within the particular application. Details of each kit can be found in
their section.

.Linux Environment
The containment area is _/home/$USER/jtsdk_ which will house the src 
(source files), build and installation folders. The *Linux SDK* is
under revision at the time of this writing. The end goal is to provide
a distribution package that installs all the needed development and
runtime packages, plus provide a series of scripts to build the various
aspects of each application.

=== General Comments
* When using any of the *SDKs*, you should not have to install any system
level software packages.
* All 5 main stream applications *( WSJT, WSJT-X, WSPR, WSPR-X and MAP65 )*
can be built using the appropriate *SDK*.
* If you have one or more required packages already installed on the
host system, the *SDK* will not interfere with your System Paths or use
System Applications to perform builds. This is to ensure no cross talk
between tools chains or libraries creep into the builds.
* This also helps the developers troubleshoot issues if they arise, 
as it provides for a consistent base from which to work.

=== JTSDK-DOC
* *JTSDK-DOC* contains: Subversion, GNU Tools and scripts to build
all *WSJT Documentation*.
* Data-URI ( single file ) builds are only possible on Linux/Mac, as
the the builds require a full Python27 implementation for base64
encoding. If you need a single file version of a document to accompany
a package, post on a web-site, etc, the Linux builds system can build
all documentation the same as Windows.
* For build details, see <<JTSDKDOC,JTSDK-DOC>>.

[[DOCMENU]]
.JTSDK-DOC Main Menu
image::images/jtsdk-doc-main.png[]

[[PYMENU]]
=== JTSDK-PY
* *JTSDK-PY* contains Python3 {plus} Modules, Subversion, Mingw32,
GNU Tools and scripts required to build *WSJT* and *WSPR*.
* For build details, see <<JTSDKPY,JTSDK-PY>>.

.JTSDK-PY Main Menu
image::images/jtsdk-py-main.png[]

=== JTSDK-QT 
* *JTSDK-QT* contains QT5, CMake, Subversion, FFTW3, Mingw48_32, GNU Tools, 
hamlib-1.2, Hamlib-3 and scripts to build *WSJT-X*, *WSPR-X* and *MAP65*.
* For build details, see <<JTSDKQT,JTSDK-QT>>.

[[QTMENU]]
.JTSDK-QT Main Menu
image::images/jtsdk-qt-main.png[]


[[PATHCFG]]
=== Path Configuration 

The following paths are used throughout {page}. 

.WINDOWS
* Scripts and final builds will under:
** C:\JTSDK-DOC
** C:\JTSDK-PY
** C:\JTSDK-QT
* Final builds end in the base %BASE_PATH%\%APP_NAME%
* Example: C:\JTSDK-QT\wsjtx

.LINUX
* Source, Build and Install folders are in:
** /home/$USER/jtsdk/$APPNAME
* Support packages, ( Hamlib3, Pmw, etc ) will reside in the
top level of JTSDK. This is to prevent issues with system level package
installations, for example:
** /home/$USER/jtsdk/hamlib3
** /home/$USER/jtsdk/pmw
* Additional packages, if needed, will be added in the same manner.

TIP: /home/$USER/jtsdk is recommended, and used in this guide. This
keeps all *WSJT Build* related activity together. For system where
a package installer is available, the actual scripts will reside at the
system level, and updated through the Distro Package Manager.

[[WININSTALL]]
== Windows SDK

Setup and installation is straight forward. Each SDK is a self
extracting 7z compressed file.

WARNING: The current update method for each *SDK* is through *JTSDK-DOC*,
as such, is a [red]#mandatory install#.

=== Download

[horizontal]
+*JTSDK-DOC*+:: {jtsdk_doc}
+*JTSDK-PY*+:: {jtsdk_py}
+*JTSDK-QT*+:: {jtsdk_qt}
+*Omni-Rig*+:: {omnirig} ( For WSJT-X CMake Builds Only )
* <<OMNIRIG,See Omni-Rig Special Instructions>>
+*Hamlib3*+:: <<HAMLIB3, See Hamlib3 Special Instructions>>

=== Install

WARNING: If you choose to install an SDK in a different location
from the recommendation, you will need to reconfigure it, basically,
rebuild the SDK from scratch.

* Double Click or Right Click and Open the download
* Change path to: C:\
* Click the Extract Button

.Self Extracting 7z File
image::images/7z-extract.png[]

* Open a Windows CMD Terminal, then type,:
* You can also browse to the env file, and double click
----

*For JTSDK-DOC*
C:\JTSDK-DOC\jtsdk-docenv.bat

*For JTSDK-PY*
C:\JTSDK-PY\jtsdk-pyenv.bat

*For JTSDK-QT*
C:\JTSDK\jtsdk-qtenv.bat

----

[[WINUPDATE]]
=== Update

To update +*JTSDK-PY, JTSDK-QT*+, or +*JTSDK-DOC*+ you must install
+*JTSDK-DOC*+ and perform a check-out. Developer check-out is *not*
required, however, if you intend to work on Documentation, use your
Developer account v.s. Anonymous so you can *( check-in )* any edits
you have made.

.Checkout & Update

* If you need to check-out first:
* Open Windows CMD Terminal, and Type:
-----
C:\JTSDK-DOC\jtsdk-docenv.bat

svn co svn://svn.code.sf.net/p/wsjt/wsjt/branches/doc

then type,

update
-----

* If you already have a checkout:
* Open Windows CMD Terminal, and Type:

-----
C:\JTSDK-DOC\jtsdk-docenv.bat

svn update

then type,

update
------

* At this point, all three *SDKs* should be up to date, if installed.
* A successful update should look similar to:

.Master Script Update
image::images/jtsdk-update.png[]

[[HAMLIB3]]
=== Hamlib3 Build
.[red]#Hamlib3 Special Build Instructions#

**********************************************************************

As of _WSJT-X v1.4.0, as custom version of Hamlib3 is required. At some
point, after official release from the Hamlib developers, we will
shift all apps using Hamlib 1.2.15 to Hamlib3. A current version of
Hamlib3 is now provided by JTSDK-QT and updated on occasion by JTSDK-DOC.
Unless asked by one of the developers, you should not have to build 
Hamlib3 from source, but, a means to do so is outlined below.

Building packages with MinGW on Windows is not trivial. However, following
the steps outlined below should produce a valid Hamlib3 build.

IMPORTANT: It is important to note that, due to the thread model
differences between MSYS/MinGW_32 and Qt5 MinGW_48_32, you must use
the Qt5 Tool Chain to build Hamlib3. The following instructions should
build the binaries without much trouble.

MSYS is not included as part of Windows JTSDK v{revision} series. The
following packages and associated build-script have been tested,
and currently employed to build Hamlib3 present in JTSDK-QT.

These instructions are still being tested, but have provided stable
builds when using the MSYS form the link below, and the build script.

Be forewarned, the script will install the newly build Hamlib3 to your
JTSDK-QT\hamlib3 directory. If for whatever reason, you want to revert
to the version provided by the *(SDK)*, simply delete the folder, and
update from *JTSDK-DOC*

//

.Custom Hamlib3 Build With MSYS
[horizontal]
+*SF Site*+:: {msys_url}
+*Download File*+:: msys{plus}7za{plus}wget{plus}svn{plus}git{plus}mercurial{plus}cvs-rev13.7z 2013-05-15

//

* Extract to: C:\msys32
* Browse to C:\msys32\msys and run the msys.bat shortcut.
* You may want to close, then re-open the msys.bat after your first run,
as the batch file creates all the required user profiles.
* Re-Open C:\msys32\msys\msys.bat
* At the log in prompt, type the following command (all on one line):
//
----------
svn export --force https://svn.code.sf.net/p/wsjt/wsjt/branches/doc/dev-guide/scripts/build-hamlib.sh
----------
//
IMPORTANT: This next step, depending on your *Single Core* CPU speed, can
take a long time to perform, upwards for 5 to 7 minutes.

//

* At the prompt, type: *./build-hamlib.sh*
* After successful completion of the build, you should have a new marker
in *C:\JTSDK-QT\hamlib3* that says something like: *build-date-<date>,*
where date is the date from your Windows Date and Time.
* From this point, build _WSJT-X_ as you normally would.

**********************************************************************

=== OmniRig Install
[[OMNIRIG]]
.[red]#OmniRig Special Instructions#

**********************************************************************

IMPORTANT: OmniRig is special requirement to build WSJT-X using CMake.
A binary installer is included with each SDK under 
C:\JTSDK-*\tools. Alternatively, you can download and install the
latest from {dxatlas}

.To Install
* OmniRig {omnirig}
* Extract .zip file and run the .exe file.
* No other actions should be required.

.To Uninstall
* OmniRig provides an Uninstaller
* *Start >> Programs >> Omni-Rig >> Uninstall Omni-Rig*

**********************************************************************

[[WIN32UNINSTALL]]
=== Uninstall
* Delete (C:\JTSDK-DOC) , (C:\JTSDK-PY) or (C:\JTSDK-QT)
* Nothing is installed to the system or registry

[[LINUXSDK]]
== Linux SDK
At the time of this writing, the *Linux SDK* is still being writting.
As development continues, updated will be added the the _{page}_.

=== Source Install
A source package will be provided to build the *SDK* components on 
systems that do not have a package installer. The installation
method will employ a simple ( ./configure, make && make install ).

Package dependency lists will be provided, but it will be up to the
user to ensure all build dependencies are met. General use tools such
as Grep, Awk, Autotools, etc will be tested by the configure script
to ensure the installation can occur.

=== Debian Install
A Debian package installer ( .deb ) will be provided by way of a
Personal Package Archive (PPA), with the hopes it will eventually be
included in Debian proper. This will allow for normal package installation
by the system package manager ( apt-get, aptitude, Gdebi, etc).
